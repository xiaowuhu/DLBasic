
## 4.6 工作原理

图 4.6.1 是从第 200 次迭代开始的连续三个独立样本的梯度下降的过程，其坐标 ($w,b$) 列在表 4.6.1 第一行中，其它点的信息以此类推。原始数据可以从【代码：check_data.txt】获得。

<img src="./img/how_it_works3.png" width=400/>

图 4.6.1 三次梯度下降过程

可以看到，算法向着梯度下降的方向走了两步以后，忽然又沿着梯度上升的方向走了一步，其原因我们在下面分析。运行【代码：H4_6_Test_Loss_1.py】可以得到彩色图。

表 4.6.1 三次迭代的数据

|迭代|迭代前的 $(w,b)$|$x$|$y$|$dw$|$db$|迭代后的 $(w,b)$|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|1|(-3.29, 5.61)| 2.34| 0| 0.2546| 0.1088|(-3.42, 5.55)|
|2|(-3.42, 5.55)| 2.27| 0| 0.2232| 0.0983|(-3.53, 5.50)|
|3|(-3.53, 5.50)| 1.06 |1| -0.1560| -0.1472|(-3.45, 5.57)|


图 4.6.2 是三个样本迭代前后的结果，运行【代码：H4_6_HowItWorks.py】可以得到此图，做局部放大后观察。其中：

- $p1、p2、p3、p4$ 表示分界点（迭代前后各有一个，用序号大小表示前后关系），它们位于两条分界斜线与 $y=0$ 的交叉点上；
- $x_1、x_2、x_3$ 表示样本，位于分界线右侧的圆点（包括 $x_1、x_2$）是负类样本，位于分界线左侧的叉子 $x_3$ 是正类样本;
- 实线表示当前分界线，虚线表示迭代后的新分界线。

<img src="./img/how_it_works1.png" />

图 4.6.2 三个样本连续迭代的结果

### 4.6.1 第一次迭代

<img src="./img/how_it_works2.png" width=480/>

图 4.6.3 计算过程图示

### 4.6.2 第二次迭代

见图 4.6.2 中图。

第二次迭代时，参与迭代的仍然是负类样本，所以会把分界线继续向左侧推开，而且斜率变大，$w_3=-3.53$，分界点从 $p2=1.62$ 左移到 $p3=1.56$。

### 4.6.3 第三次迭代

### 4.6.4 多个样本的情况

<img src="./img/loss_1_2.png" width=800/>

见图 4.6.4 单类样本和双类样本的损失函数形态
